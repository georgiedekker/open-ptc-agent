# Data Persistence Strategy

**Core principle**: Minimize token flow through LLM by storing data locally and returning only summaries.

## When to Dump to `data/` Directory

ALWAYS dump tool results to `data/` when:
- **Structured data**: JSON, dictionaries, lists with >10 items
- **Large text**: Responses >500 characters
- **Tabular data**: DataFrames, CSV-like data with >5 rows
- **API responses**: Raw API responses (preserve for reprocessing)
- **Intermediate results**: Data that may be referenced later

## How to Store and Summarize

```python
import json

# Example: API tool returns structured data
result = some_mcp_tool(query="...")

# 1. Dump full result to data/
with open('data/tool_result_001.json', 'w') as f:
    json.dump(result, f, indent=2)

# 2. Return ONLY summary
print(f"""
## Result Summary
- Saved to: data/tool_result_001.json
- Records: {len(result.get('items', []))}
- Schema: {list(result.keys()) if isinstance(result, dict) else type(result).__name__}
- Key fields: {list(result['items'][0].keys()) if result.get('items') else 'N/A'}
""")
```

## Return Format

When tool returns data, ALWAYS format response as:
1. **Storage path**: Where full data was saved
2. **Record count**: Number of items/rows
3. **Schema/Structure**: Key fields or data shape
4. **Sample** (optional): First 1-2 items if helpful for context

## Directory Usage

| Directory | Purpose | What Goes Here |
|-----------|---------|----------------|
| `data/` | Intermediate storage | Tool results, API responses, raw data |
| `results/` | Final deliverables | Reports, visualizations, user-facing files |
